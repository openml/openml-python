<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Creating and Using a Custom Flow &#8212; OpenML 0.15.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css?v=284a2d1d" />
    <link rel="stylesheet" type="text/css" href="../../_static/codehighlightstyle.css?v=180e76fa" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=97b2f34b"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>

  </head><body>
  
  <a href="https://github.com/openml/openml-python"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          OpenML</a>
        <span class="navbar-text navbar-version pull-left"><b>0.15.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../index.html">Start</a></li>
                <li><a href="../../usage.html">User Guide</a></li>
                <li><a href="../../api.html">API</a></li>
                <li><a href="../index.html">Examples</a></li>
                <li><a href="../../extensions.html">Extensions</a></li>
                <li><a href="../../contributing.html">Contributing</a></li>
                <li><a href="../../progress.html">Changelog</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Creating and Using a Custom Flow</a><ul>
<li><a class="reference internal" href="#defining-the-flow">1. Defining the flow</a></li>
<li><a class="reference internal" href="#using-the-flow">2. Using the flow</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-30-extended-custom-flow-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="creating-and-using-a-custom-flow">
<span id="sphx-glr-examples-30-extended-custom-flow-py"></span><h1>Creating and Using a Custom Flow<a class="headerlink" href="#creating-and-using-a-custom-flow" title="Permalink to this heading">¶</a></h1>
<p>The most convenient way to create a flow for your machine learning workflow is to generate it
automatically as described in the <a class="reference internal" href="flow_id_tutorial.html#sphx-glr-examples-30-extended-flow-id-tutorial-py"><span class="std std-ref">Obtaining Flow IDs</span></a> tutorial.
However, there are scenarios where this is not possible, such
as when the flow uses a framework without an extension or when the flow is described by a script.</p>
<p>In those cases you can still create a custom flow by following the steps of this tutorial.
As an example we will use the flows generated for the <a class="reference external" href="https://openml.github.io/automlbenchmark/">AutoML Benchmark</a>,
and also show how to link runs to the custom flow.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># License: BSD 3-Clause</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">openml</span>
<span class="kn">from</span> <span class="nn">openml</span> <span class="kn">import</span> <span class="n">OpenMLClassificationTask</span>
<span class="kn">from</span> <span class="nn">openml.runs.functions</span> <span class="kn">import</span> <span class="n">format_prediction</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This example uploads data. For that reason, this example connects to the test server at test.openml.org.
This prevents the main server from crowding with example datasets, tasks, runs, and so on.
The use of this test server can affect behaviour and performance of the OpenML-Python API.</p>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">openml</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">start_using_configuration_for_example</span><span class="p">()</span>
</pre></div>
</div>
<section id="defining-the-flow">
<h2>1. Defining the flow<a class="headerlink" href="#defining-the-flow" title="Permalink to this heading">¶</a></h2>
<p>The first step is to define all the hyperparameters of your flow.
The API pages feature a descriptions of each variable of the <a class="reference internal" href="../../generated/openml.flows.OpenMLFlow.html#openml.flows.OpenMLFlow" title="openml.flows.OpenMLFlow"><code class="xref py py-class docutils literal notranslate"><span class="pre">openml.flows.OpenMLFlow</span></code></a>.
Note that <cite>external version</cite> and <cite>name</cite> together uniquely identify a flow.</p>
<p>The AutoML Benchmark runs AutoML systems across a range of tasks.
OpenML stores Flows for each AutoML system. However, the AutoML benchmark adds
preprocessing to the flow, so should be described in a new flow.</p>
<p>We will break down the flow arguments into several groups, for the tutorial.
First we will define the name and version information.
Make sure to leave enough information so others can determine exactly which
version of the package/script is used. Use tags so users can find your flow easily.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">general</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;automlbenchmark_autosklearn&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="p">(</span>
        <span class="s2">&quot;Auto-sklearn as set up by the AutoML Benchmark&quot;</span>
        <span class="s2">&quot;Source: https://github.com/openml/automlbenchmark/releases/tag/v0.9&quot;</span>
    <span class="p">),</span>
    <span class="n">external_version</span><span class="o">=</span><span class="s2">&quot;amlb==0.9&quot;</span><span class="p">,</span>
    <span class="n">language</span><span class="o">=</span><span class="s2">&quot;English&quot;</span><span class="p">,</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;amlb&quot;</span><span class="p">,</span> <span class="s2">&quot;benchmark&quot;</span><span class="p">,</span> <span class="s2">&quot;study_218&quot;</span><span class="p">],</span>
    <span class="n">dependencies</span><span class="o">=</span><span class="s2">&quot;amlb==0.9&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Next we define the flow hyperparameters. We define their name and default value in <cite>parameters</cite>,
and provide meta-data for each hyperparameter through <cite>parameters_meta_info</cite>.
Note that even though the argument name is <cite>parameters</cite> they describe the hyperparameters.
The use of ordered dicts is required.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">flow_hyperparameters</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">parameters</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;240&quot;</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="s2">&quot;32&quot;</span><span class="p">,</span> <span class="n">cores</span><span class="o">=</span><span class="s2">&quot;8&quot;</span><span class="p">),</span>
    <span class="n">parameters_meta_info</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">(</span>
        <span class="n">cores</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;number of available cores&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">memory</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;memory in gigabytes&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">time</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;time in minutes&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>It is possible to build a flow which uses other flows.
For example, the Random Forest Classifier is a flow, but you could also construct a flow
which uses a Random Forest Classifier in a ML pipeline. When constructing the pipeline flow,
you can use the Random Forest Classifier flow as a <em>subflow</em>. It allows for
all hyperparameters of the Random Classifier Flow to also be specified in your pipeline flow.</p>
<p>Note: you can currently only specific one subflow as part of the components.</p>
<p>In this example, the auto-sklearn flow is a subflow: the auto-sklearn flow is entirely executed as part of this flow.
This allows people to specify auto-sklearn hyperparameters used in this flow.
In general, using a subflow is not required.</p>
<p>Note: flow 9313 is not actually the right flow on the test server,
but that does not matter for this demonstration.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">autosklearn_flow</span> <span class="o">=</span> <span class="n">openml</span><span class="o">.</span><span class="n">flows</span><span class="o">.</span><span class="n">get_flow</span><span class="p">(</span><span class="mi">9313</span><span class="p">)</span>  <span class="c1"># auto-sklearn 0.5.1</span>
<span class="n">subflow</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">components</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">(</span><span class="n">automl_tool</span><span class="o">=</span><span class="n">autosklearn_flow</span><span class="p">),</span>
    <span class="c1"># If you do not want to reference a subflow, you can use the following:</span>
    <span class="c1"># components=OrderedDict(),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>With all parameters of the flow defined, we can now initialize the OpenMLFlow and publish.
Because we provided all the details already, we do not need to provide a <cite>model</cite> to the flow.</p>
<p>In our case, we don’t even have a model. It is possible to have a model but still require
to follow these steps when the model (python object) does not have an extensions from which
to automatically extract the hyperparameters.
So whether you have a model with no extension or no model at all, explicitly set
the model of the flow to <cite>None</cite>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">autosklearn_amlb_flow</span> <span class="o">=</span> <span class="n">openml</span><span class="o">.</span><span class="n">flows</span><span class="o">.</span><span class="n">OpenMLFlow</span><span class="p">(</span>
    <span class="o">**</span><span class="n">general</span><span class="p">,</span>
    <span class="o">**</span><span class="n">flow_hyperparameters</span><span class="p">,</span>
    <span class="o">**</span><span class="n">subflow</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">autosklearn_amlb_flow</span><span class="o">.</span><span class="n">publish</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;autosklearn flow created: </span><span class="si">{</span><span class="n">autosklearn_amlb_flow</span><span class="o">.</span><span class="n">flow_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-the-flow">
<h2>2. Using the flow<a class="headerlink" href="#using-the-flow" title="Permalink to this heading">¶</a></h2>
<p>This Section will show how to upload run data for your custom flow.
Take care to change the values of parameters as well as the task id,
to reflect the actual run.
Task and parameter values in the example are fictional.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">flow_id</span> <span class="o">=</span> <span class="n">autosklearn_amlb_flow</span><span class="o">.</span><span class="n">flow_id</span>

<span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;oml:name&quot;</span><span class="p">,</span> <span class="s2">&quot;cores&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;oml:value&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;oml:component&quot;</span><span class="p">,</span> <span class="n">flow_id</span><span class="p">)]),</span>
    <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;oml:name&quot;</span><span class="p">,</span> <span class="s2">&quot;memory&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;oml:value&quot;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;oml:component&quot;</span><span class="p">,</span> <span class="n">flow_id</span><span class="p">)]),</span>
    <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;oml:name&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;oml:value&quot;</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;oml:component&quot;</span><span class="p">,</span> <span class="n">flow_id</span><span class="p">)]),</span>
<span class="p">]</span>

<span class="n">task_id</span> <span class="o">=</span> <span class="mi">1200</span>  <span class="c1"># Iris Task</span>
<span class="n">task</span> <span class="o">=</span> <span class="n">openml</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">get_task</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
<span class="n">dataset_id</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">()</span><span class="o">.</span><span class="n">dataset_id</span>
</pre></div>
</div>
<p>The last bit of information for the run we need are the predicted values.
The exact format of the predictions will depend on the task.</p>
<p>The predictions should always be a list of lists, each list should contain:</p>
<ul class="simple">
<li><p>the repeat number: for repeated evaluation strategies. (e.g. repeated cross-validation)</p></li>
<li><p>the fold number: for cross-validation. (what should this be for holdout?)</p></li>
<li><p>0: this field is for backward compatibility.</p></li>
<li><p>index: the row (of the original dataset) for which the prediction was made.</p></li>
<li><p>p_1, …, p_c: for each class the predicted probability of the sample
belonging to that class. (no elements for regression tasks)
Make sure the order of these elements follows the order of <cite>task.class_labels</cite>.</p></li>
<li><p>the predicted class/value for the sample</p></li>
<li><p>the true class/value for the sample</p></li>
</ul>
<p>When using openml-python extensions (such as through <cite>run_model_on_task</cite>),
all of this formatting is automatic.
Unfortunately we can not automate this procedure for custom flows,
which means a little additional effort is required.</p>
<p>Here we generated some random predictions in place.
You can ignore this code, or use it to better understand the formatting of the predictions.</p>
<p>Find the repeats/folds for this task:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">n_repeats</span><span class="p">,</span> <span class="n">n_folds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">get_split_dimensions</span><span class="p">()</span>
<span class="n">all_test_indices</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">repeat</span><span class="p">,</span> <span class="n">fold</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">repeat</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_repeats</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_folds</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">task</span><span class="o">.</span><span class="n">get_train_test_split_indices</span><span class="p">(</span><span class="n">fold</span><span class="p">,</span> <span class="n">repeat</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># random class probabilities (Iris has 150 samples and 3 classes):</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">150</span> <span class="o">*</span> <span class="n">n_repeats</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="c1"># scale the random values so that the probabilities of each sample sum to 1:</span>
<span class="n">y_proba</span> <span class="o">=</span> <span class="n">r</span> <span class="o">/</span> <span class="n">r</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_proba</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">class_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">task</span><span class="o">.</span><span class="n">class_labels</span><span class="p">))</span>
<span class="n">_</span><span class="p">,</span> <span class="n">y_true</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">get_X_and_y</span><span class="p">()</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="p">[</span><span class="n">class_map</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">y_true</span><span class="p">]</span>

<span class="c1"># We format the predictions with the utility function `format_prediction`.</span>
<span class="c1"># It will organize the relevant data in the expected format/order.</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">where</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="n">proba</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">all_test_indices</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_proba</span><span class="p">):</span>
    <span class="n">repeat</span><span class="p">,</span> <span class="n">fold</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">where</span>

    <span class="n">prediction</span> <span class="o">=</span> <span class="n">format_prediction</span><span class="p">(</span>
        <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">,</span>
        <span class="n">repeat</span><span class="o">=</span><span class="n">repeat</span><span class="p">,</span>
        <span class="n">fold</span><span class="o">=</span><span class="n">fold</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
        <span class="n">prediction</span><span class="o">=</span><span class="n">class_map</span><span class="p">[</span><span class="n">yp</span><span class="p">],</span>
        <span class="n">truth</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
        <span class="n">proba</span><span class="o">=</span><span class="p">{</span><span class="n">c</span><span class="p">:</span> <span class="n">pb</span> <span class="k">for</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">pb</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">task</span><span class="o">.</span><span class="n">class_labels</span><span class="p">,</span> <span class="n">proba</span><span class="p">)},</span>
    <span class="p">)</span>
    <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally we can create the OpenMLRun object and upload.
We use the argument setup_string because the used flow was a script.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">benchmark_command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;python3 runbenchmark.py auto-sklearn medium -m aws -t 119&quot;</span>
<span class="n">my_run</span> <span class="o">=</span> <span class="n">openml</span><span class="o">.</span><span class="n">runs</span><span class="o">.</span><span class="n">OpenMLRun</span><span class="p">(</span>
    <span class="n">task_id</span><span class="o">=</span><span class="n">task_id</span><span class="p">,</span>
    <span class="n">flow_id</span><span class="o">=</span><span class="n">flow_id</span><span class="p">,</span>
    <span class="n">dataset_id</span><span class="o">=</span><span class="n">dataset_id</span><span class="p">,</span>
    <span class="n">parameter_settings</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
    <span class="n">setup_string</span><span class="o">=</span><span class="n">benchmark_command</span><span class="p">,</span>
    <span class="n">data_content</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;study_218&quot;</span><span class="p">],</span>
    <span class="n">description_text</span><span class="o">=</span><span class="s2">&quot;Run generated by the Custom Flow tutorial.&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">my_run</span><span class="o">.</span><span class="n">publish</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;run created:&quot;</span><span class="p">,</span> <span class="n">my_run</span><span class="o">.</span><span class="n">run_id</span><span class="p">)</span>

<span class="n">openml</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">stop_using_configuration_for_example</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-30-extended-custom-flow-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/cd015a0038fe3d4ebe69c12134b7dc35/custom_flow_.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">custom_flow_.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/8c360a24a862fc5b2df293439dbd1564/custom_flow_.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">custom_flow_.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/5d823cb09ebccd25683a92cecff5d7b0/custom_flow_.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">custom_flow_.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014-2024, the OpenML-Python team.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.1.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>